# Decision Log

Этот файл записывает архитектурные и реализационные решения в формате списка.
2026-01-12 16:58:30 - Последняя редакция базового описания.

## Правила редактирования

* Записи в разделах должны быть отсортированы в обратном хронологическом порядке (самые новые сверху, старые внизу).
* Каждая запись должна начинаться с даты редакции в формате ГГГГ-ММ-ДД ЧЧ:ММ:СС.
2026-01-12 16:58:30 - Последняя редакция правил редактирования.

## Записи MCP

## Решение: Полная синхронизация документации схемы БД с актуальной структурой через MCP запрос
2025-04-02 01:12:10 - Решение: Полная синхронизация документации схемы БД с актуальной структурой через MCP запрос. Добавлены недостающие таблицы, индексы и связи.
### Обоснование
* Необходимость актуальной документации для поддержания целостности проекта.
### Детали реализации
* Запрос через MCP для обновления схемы.
* Добавление таблиц embeddings, query_embeddings, user_groups.
* Уточнение связей и ограничений.

## Решение: Критическое решение по безопасности
2025-10-05 00:00:00 - Решение: Полное удаление жестко закодированного OpenAI API ключа из кода и git истории
### Обоснование
* Обеспечение безопасности конфиденциальной информации, предотвращение утечек API ключей через git репозиторий.
### Детали реализации
* Замена жестко закодированного ключа на переменную окружения в settings-maymunai.py.
* Использование git filter-branch для удаления секрета из истории коммитов.
* Настройка безопасного хранения ключа в .env файле.
### Результат
* Репозиторий защищен от утечек, код использует безопасные практики хранения конфиденциальной информации.

## Решение: Решение по восстановлению git репозитория
2025-10-05 00:01:00 - Решение: Полная диагностика и восстановление работоспособности git репозитория
### Обоснование
* Необходимость стабильной работы системы контроля версий для дальнейшего развития проекта.
### Детали реализации
* Диагностика и устранение проблем с git индексом и объектами.
* Разрешение конфликтов слияния между локальной и удаленной ветками.
* Настройка аутентификации с GitHub.
* Очистка временных файлов и артефактов.
### Результат
* Полностью функциональный git репозиторий, синхронизированный с удаленным origin.

## Решение: Общая архитектура RAG и компоненты
2025-03-30 00:02:32 - Решение: Общая архитектура RAG и компоненты
### Обоснование
* RAG позволяет генерировать ответы на основе конкретной базы знаний, что повышает точность и релевантность ответов.
* PostgreSQL обеспечивает надежное хранение данных и поддерживает векторные операции для работы с эмбеддингами.
* Модели OpenAI предоставляют высококачественные эмбеддинги и генерацию текста.
* Кэширование эмбеддингов снижает количество запросов к API и ускоряет работу системы.
* Иерархическая структура данных позволяет лучше организовать информацию и учитывать контекст.
* Интерактивный режим отладки упрощает разработку и настройку системы.
### Детали реализации
* Использование технологии RAG (Retrieval-Augmented Generation) для создания персонального ассистента.
* Выбор PostgreSQL в качестве базы данных для хранения элементов и эмбеддингов.
* Использование моделей OpenAI для генерации эмбеддингов и ответов.
* Реализация кэширования эмбеддингов для повышения производительности.
* Создание иерархической структуры данных с родительскими и дочерними элементами.
* Разработка интерактивного режима отладки с возможностью настройки параметров.
* Использование text-embedding-3-large для генерации эмбеддингов с размерностью 3072.
* Использование gpt-4-turbo-preview для генерации ответов.
* Хранение эмбеддингов в базе данных с использованием типа VECTOR.
* Реализация косинусного сходства для поиска релевантных документов.
* Использование порогового значения сходства для фильтрации результатов.
* Автоматическая генерация ключевых слов для запросов с использованием GPT-3.5 Turbo.
* Реализация механизма миграции базы данных для обновления схемы.

## Решение: Документирование параметров запуска
2025-03-30 20:10:09 - Решение: Документирование параметров запуска
### Обоснование
* Улучшение документации проекта.
### Детали реализации
* Добавлено детальное описание параметров запуска в productContext.md и systemPatterns.md.