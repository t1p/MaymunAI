# Active Context

Этот файл отслеживает текущий статус проекта, включая недавние изменения, текущие цели и открытые вопросы.
2026-01-12 18:38:00 - Последняя редакция базового описания.

## Правила редактирования

* Записи в разделах должны быть отсортированы в обратном хронологическом порядке (самые новые сверху, старые внизу).
* Каждая запись должна начинаться с даты редакции в формате ГГГГ-ММ-ДД ЧЧ:ММ:СС.
2026-01-12 18:38:00 - Последняя редакция правил редактирования.

## Текущий фокус

2026-01-17 01:29:40 - Запуск Фазы 1: рефакторинг структуры и совместимость CLI/main.py; подготовлены каркасы модулей core/db/rag/modes/cli и config.yaml.
2025-05-16 02:41:00 - Проведен анализ настройки режимов в Roo-Code и RooFlow с Memory Bank. Результаты сохранены в файле roo_code_integration.md
2025-04-07 09:05:30 - Текущий фокус: интеграция изменений в retrieval.py
* Успешно исправлены ошибки форматов данных
* Проведено тестирование изменений
* Готово к мержу в основную ветку
2025-04-02 01:11:30 - Обновлена документация схемы PostgreSQL. Добавлены новые таблицы (embeddings, query_embeddings, user_groups), уточнены связи и ограничения.

## Недавние изменения

2026-01-17 02:09:20 - Добавлены тесты retriever_fastgpt/retriever_ragflow и устранены заглушки NotImplementedError в ретриверах.
2026-01-17 03:03:17 - Исправлен парсинг config.yaml: mcp.pg_server теперь маппится в MCPPostgresServer; добавлены тесты загрузки конфигурации.
2026-01-17 01:47:32 - Обновлена документация (README/DOCKER_README) и добавлен план тестирования/валидации.
2026-01-17 01:45:55 - Добавлены CLI-каркасы ingest_docs, build_index, test_query с argparse.
2026-01-17 01:44:28 - Добавлены загрузчик промптов и базовые шаблоны prompts/system и prompts/modes; обновлено логирование (JSON формат).
2026-01-17 01:43:11 - Добавлен каркас MCP-сервера с registry tools (retrieval, info.schema); pg_mcp_client оставлен как интерфейс.
2026-01-17 01:41:49 - Завершён RAG-native слой: embed_openai, index_pgvector, retriever_native, compose_context (минимальная реализация).
2026-01-17 01:39:58 - Завершён DB-слой: нативный адаптер pg_native, интерфейсы pg_mcp_client и schema_introspect (минимальная реализация).
2026-01-17 01:33:03 - Реализованы базовые REST-клиенты ретриверов FastGPT/RAGFlow и добавлены docker-compose для их запуска.
2026-01-17 01:29:40 - Добавлены каркасы модулей для новой структуры, config.yaml и совместимый раннер client/mcp_server; добавлен pyyaml в зависимости.
2025-05-16 02:41:00 - Проведен анализ настройки режимов в Roo-Code и RooFlow с Memory Bank. Результаты сохранены в файле roo_code_integration.md
2025-04-07 09:05:30 - Исправлены ошибки форматов данных в retrieval.py
2025-04-02 01:11:30 - Синхронизирована документация схемы БД с актуальной структурой
* Создание Memory Bank для отслеживания проекта
* Анализ исходного кода и структуры проекта

## Уточненная информация о среде выполнения

2025-05-19 00:00:00 - Информация о среде выполнения на момент последнего анализа
* **Имя узла**: 82KU
* **ОС**: Windows 11 Pro (24H2)
* **Версия**: 10.0.26100 (сборка 26100)
* **Производитель**: Microsoft Corporation
* **Тип системы**: x64-based PC
* **Процессор**: AMD64 Family 23 Model 104 (2100 МГц)
* **Память**: 5 989 МБ физической
* **Дата установки**: 08.03.2025
* **Каталог Windows**: C:\Windows
* **Системный каталог**: C:\Windows\system32
* **Установленные программы**: Python 3.11.9, PostgreSQL 17.4
* **Параметры БД**: DB name: maymunai, User: maymun, Host: localhost, Port: 5432
* **Сетевые параметры**: Адаптер 1: Qualcomm Atheros QCA61x4A (IP: 192.168.11.234, DHCP: 192.168.11.1), Адаптер 2: Bluetooth (отключен)
* **Безопасность**: Исправления: KB5049622, KB5053598, KB5052915; Виртуализация: активна; Безопасная загрузка: включена; Защита DMA: активна

## Открытые вопросы/проблемы

2025-04-07 09:05:30 - Как обрабатываются ошибки API OpenAI и сбои в работе базы данных?
2025-04-02 01:11:30 - Как настроена аутентификация для доступа к базе данных PostgreSQL?
* Существует ли файл settings.py с реальными настройками (есть только settings.example.py)?
* Как обрабатываются длинные тексты, превышающие лимиты токенов для моделей OpenAI?
* Как организовано тестирование системы?
* Какие метрики используются для оценки качества ответов?
