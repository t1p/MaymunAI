[2025-04-07 09:28:36] - Паттерны обработки эмбеддингов:
1. Поддержка chunked/не chunked режимов:
   - Проверка наличия 'embeddings' или 'embedding'
   - Использование первого эмбеддинга для chunked режима
2. Валидация обязательных полей:
   - Проверка наличия 'text' перед обработкой
   - Логирование ошибок при отсутствии полей
# System Patterns *Optional*

This file documents recurring patterns and standards used in the project.
It is optional, but recommended to be updated as the project evolves.
2025-03-30 00:02:47 - Log of updates made.

*

## Coding Patterns

* **Декораторы для измерения времени**: Использование декоратора `@timeit` для измерения времени выполнения функций
* **Логирование**: Использование стандартного модуля logging для логирования с настройкой уровня в зависимости от режима отладки
* **Обработка ошибок**: Использование try-except блоков с логированием ошибок и возвратом значений по умолчанию
* **Контекстные менеджеры**: Использование `with` для работы с соединениями базы данных
* **Типизация**: Использование аннотаций типов из модуля typing для улучшения читаемости кода
* **Параметры по умолчанию**: Использование значений из конфигурации, если параметры не указаны явно

## Architectural Patterns

* **RAG (Retrieval-Augmented Generation)**: Поиск релевантных документов и генерация ответов на их основе
* **Кэширование**: Сохранение эмбеддингов в базе данных для повторного использования
* **Иерархическая структура данных**: Организация элементов в виде дерева с родительскими и дочерними элементами
* **Конфигурация**: Централизованное хранение настроек в модуле config.py и базе данных
* **Модульность**: Разделение функциональности по отдельным модулям (embeddings.py, retrieval.py, rag.py и т.д.)
* **CLI Интерфейс**: Использование argparse для обработки параметров командной строки с иерархической структурой команд
* **Интерактивный режим отладки**: Возможность настройки параметров в процессе выполнения
* **Гибридный поиск**: Комбинация векторного (семантического) и текстового (BM25) поиска с настраиваемыми весами
* **Семантическое чанкование**: Разбиение документов по смысловым границам с перекрытием
* **Реранжирование**: Использование кросс-энкодеров для улучшения порядка результатов поиска
* **Система оценки**: Метрики precision@k, recall и NDCG для объективной оценки качества

## Testing Patterns

* Отсутствуют явные паттерны тестирования в текущей кодовой базе
* Рекомендуется добавить:
  * Модульные тесты для отдельных компонентов
  * Интеграционные тесты для проверки взаимодействия компонентов
  * Тесты производительности для выявления узких мест
  * Тесты качества ответов для оценки релевантности и точности